<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Kalandlap - Digitális karakterlap A Baziliszkusz Árnyéka c. könyvhöz">
    <title>A Baziliszkus Árnyéka - Kalandlap</title>
    <!-- CSS Modules - Order matters! -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/chargen.css">
    <link rel="stylesheet" href="css/dice.css">
</head>

<body>
    <div class="container">
        <main class="parchment">
            <!-- Header -->
            <header>
                <h1>KALANDLAP</h1>
            </header>

            <!-- Main Content Grid -->
            <div class="content-grid">
                <!-- Player Stats -->
                <section class="stats-section" aria-label="Karakter statisztikák">
                    <div class="form-group">
                        <label for="body">TEST:</label>
                        <input type="number" id="body" min="0" max="99" value="0" aria-label="Test érték">
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="skill">KECSESSÉG:</label>
                        <input type="number" id="skill" min="0" max="99" value="0" aria-label="Kecsesség érték">
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="mind">ELME:</label>
                        <input type="number" id="mind" min="0" max="99" value="0" aria-label="Elme érték">
                    </div>
                </section>

                <!-- Character Background -->
                <section class="combat-section" aria-label="Karakter háttér">
                    <div class="form-group">
                        <label for="class">ALKASZT:</label>
                        <select id="class" aria-label="Válassz alkasztot">
                            <option value="">-- VÁLASSZ --</option>
                            <option value="magusvadasz">Mágusvadász</option>
                            <option value="szabotor">Szabotőr</option>
                            <option value="vereb">Véreb</option>
                        </select>
                        <div class="field-bonus" id="classBonus"></div>
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="past">MÚLT:</label>
                        <select id="past" aria-label="Válassz múltat">
                            <option value="">-- VÁLASSZ --</option>
                            <option value="testor">Egy nagyhatalmú mágus testőre</option>
                            <option value="ostora">A Birodalom ellenségeinek ostora</option>
                            <option value="tulelo">Magiko-technikus kísérletek túlélője</option>
                        </select>
                        <div class="field-bonus" id="pastBonus"></div>
                    </div>
                </section>

                <!-- Equipment -->
                <section class="equipment-section" aria-label="Felszerelés">
                    <div class="form-group">
                        <label for="equipment">FELSZERELÉS:</label>
                        <textarea id="equipment" rows="12" aria-label="Felszerelés lista"></textarea>
                    </div>
                </section>

                <!-- Spells and Notes -->
                <section class="spells-notes-section" aria-label="Varázslatok és jegyzetek">
                    <div class="form-group">
                        <label for="spells">VARÁZSLATOK:</label>
                        <textarea id="spells" rows="5" aria-label="Varázslatok lista"></textarea>
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="notes">FELJEGYZÉSEK:</label>
                        <textarea id="notes" rows="5" aria-label="Jegyzetek"></textarea>
                    </div>
                </section>

                <!-- Battle Tracker -->
                <section class="battle-grid" aria-label="Harc követő">
                    <!-- Battle cards will be generated by JavaScript -->
                </section>
            </div>

            <!-- Action Buttons -->
            <div class="actions">
                <button id="saveBtn" class="btn btn-primary">&#128190; MENTÉS</button>
                <button id="loadBtn" class="btn btn-secondary">&#128194; BETÖLTÉS</button>
                <button id="exportBtn" class="btn btn-secondary">&#128229; EXPORTÁLÁS</button>
                <button id="importBtn" class="btn btn-secondary">&#128193; IMPORTÁLÁS</button>
                <button id="charGenBtn" class="btn btn-primary">&#9889; KARAKTER GENERÁLÁS</button>
                <button id="diceBtn" class="btn btn-primary">&#127922; KOCKADOBÁS</button>
                <button id="helpBtn" class="btn btn-secondary">&#10067; SÚGÓ</button>
                <button id="resetBtn" class="btn btn-danger">&#128260; ÚJRAKEZDÉS</button>
                <input type="file" id="importFile" accept=".json" style="display: none;">
            </div>

            <!-- Hidden file input -->
            <input type="file" id="importFile" accept=".json" style="display: none;" aria-hidden="true">
        </main>
    </div>

    <!-- Templates (hidden) -->
    <template id="dice-roller-template">
        <div class="dice-roller-content sidebar-content custom-scrollbar">
            <button class="sidebar-close" id="diceClose">✕</button>
            <h2>KOCKADOBÁS</h2>

            <div class="dice-section">
                <h3>Egyszerű dobás</h3>
                <div class="dice-result" id="diceResult">
                    <span class="result-number">?</span>
                </div>
                <div class="dice-buttons">
                    <button class="dice-btn" id="roll1d6">1D6</button>
                    <button class="dice-btn" id="roll2d6">2D6</button>
                </div>
            </div>

            <div class="dice-section">
                <h3>Harc dobás</h3>
                <div class="battle-rolls">
                    <div class="battle-roll">
                        <h4>JÁTÉKOS</h4>
                        <div class="battle-result" id="attackerRoll">?</div>
                    </div>
                    <div class="battle-roll">
                        <h4>ELLENFÉL</h4>
                        <div class="battle-result" id="defenderRoll">?</div>
                    </div>
                </div>
                <div class="dice-buttons">
                    <button class="dice-btn" id="rollBattle">HARC DOBÁS</button>
                </div>
            </div>

            <div class="dice-history" id="diceHistory">
                <h3>TÖRTÉNET</h3>
                <div class="history-items"></div>
            </div>
        </div>
    </template>

    <template id="chargen-template">
        <div class="chargen-content sidebar-content custom-scrollbar">
            <button class="sidebar-close" id="chargenClose">✕</button>
            <h2>KARAKTER GENERÁLÁS</h2>

            <div class="chargen-info">
                <strong>Alap értékek:</strong><br>
                Test: 18 | Kecsesség: 7 | Elme: 7<br>
                Max varázslatok: 1<br><br>
                <strong>14 fejlődéspont</strong> áll rendelkezésre.
            </div>

            <!-- Points Display -->
            <div class="chargen-section">
                <div class="points-display">
                    <div class="points-remaining" id="pointsRemaining">14</div>
                    <div class="points-label">Fejlődéspont</div>
                </div>
            </div>

            <!-- Stats (TEST, KECSESSÉG, ELME, MAX VARÁZSLATOK) -->
            <div class="chargen-section">
                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">TEST</span>
                        <span class="stat-value" id="genBody">18</span>
                    </div>
                    <div class="stat-controls" id="bodyControls"></div>
                    <div class="stat-cost">+1 = 1 pont (max +10)</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">KECSESSÉG</span>
                        <span class="stat-value" id="genSkill">7</span>
                    </div>
                    <div class="stat-controls" id="skillControls"></div>
                    <div class="stat-cost">+1 = 2 pont | +2 = 5 pont | +3 = 9 pont</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">ELME</span>
                        <span class="stat-value" id="genMind">7</span>
                    </div>
                    <div class="stat-controls" id="mindControls"></div>
                    <div class="stat-cost">+1 = 2 pont | +2 = 5 pont | +3 = 9 pont</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">MAX VARÁZSLATOK</span>
                        <span class="stat-value" id="genSpells">1</span>
                    </div>
                    <div class="stat-controls" id="spellsControls"></div>
                    <div class="stat-cost">+1 = 4 pont | +2 = 8 pont (max +2)</div>
                </div>
            </div>

            <!-- Spell Selection -->
            <div class="chargen-section">
                <div class="spell-selection">
                    <h4>VARÁZSLAT VÁLASZTÁS</h4>
                    <div class="spell-list" id="spellList"></div>
                    <div class="spell-counter" id="spellCounter">
                        <span id="selectedSpellCount">0</span> / <span id="maxSpellCount">1</span> varázslat kiválasztva
                    </div>
                </div>
            </div>

            <!-- Class Selection -->
            <div class="chargen-section">
                <div class="class-background-selection">
                    <h3>ALKASZT</h3>
                    <select id="classSelect" class="class-select">
                        <option value="">-- VÁLASSZ --</option>
                        <option value="magusvadasz">Mágusvadász</option>
                        <option value="szabotor">Szabotőr</option>
                        <option value="vereb">Véreb</option>
                    </select>
                    <div class="bonus-display" id="classBonus" style="display: none;"></div>
                </div>
            </div>

            <!-- Background Selection -->
            <div class="chargen-section">
                <div class="class-background-selection">
                    <h3>MÚLT</h3>
                    <select id="backgroundSelect" class="background-select">
                        <option value="">-- VÁLASSZ --</option>
                        <option value="testor">Egy nagyhatalmú mágus testőre</option>
                        <option value="ostora">A Birodalom ellenségeinek ostora</option>
                        <option value="tulelo">Magiko-technikus kísérletek túlélője</option>
                    </select>
                    <div class="bonus-display" id="backgroundBonus" style="display: none;"></div>
                </div>
            </div>

            <!-- Actions -->
            <div class="chargen-actions">
                <button class="action-btn primary" id="applyCharGen">
                    &#10004; ALKALMAZ
                </button>
                <button class="action-btn" id="resetCharGen">
                    &#8634; VISSZAÁLLÍT
                </button>
            </div>
        </div>
    </template>

    <template id="help-modal-template">
        <div class="help-content">
            <button class="help-close">✕</button>
            <h2>SÚGÓ</h2>

            <h3>Billentyűparancsok</h3>
            <div class="help-shortcuts">
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + S</span>
                    <span class="shortcut-desc">Kalandlap mentése</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + L</span>
                    <span class="shortcut-desc">Kalandlap betöltése</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + E</span>
                    <span class="shortcut-desc">Exportálás fájlba</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + I</span>
                    <span class="shortcut-desc">Importálás fájlból</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + G</span>
                    <span class="shortcut-desc">Karakter generálás</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + D</span>
                    <span class="shortcut-desc">Kockadobó megnyitása</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + H</span>
                    <span class="shortcut-desc">Súgó megjelenítése</span>
                </div>
            </div>

            <h3>Funkciók</h3>
            <ul class="help-features">
                <li><strong>Automatikus mentés:</strong> Az adatok 30 másodpercenként automatikusan mentésre kerülnek
                </li>
                <li><strong>Helyi tárolás:</strong> Az adatok a böngésző helyi tárhelyén kerülnek mentésre</li>
                <li><strong>Export/Import:</strong> JSON fájlba mentheted és onnan visszatöltheted az adatokat</li>
                <li><strong>Kockadobó:</strong> 1D6, 2D6 dobása és harc dobás 2D6 vs 2D6</li>
                <li><strong>Karakter generálás:</strong> A könyv szabályai alapján</li>
                <li><strong>Ellenfél követés:</strong> 9 ellenfél statisztikáinak nyomon követése</li>
            </ul>
        </div>
    </template>

    <template id="battle-card-template">
        <div class="battle-card">
            <div class="form-group">
                <label>TEST:</label>
                <input type="number" min="0" max="99" value="0" data-stat="body">
            </div>
            <div class="form-group">
                <label>KECSESSÉG:</label>
                <input type="number" min="0" max="99" value="0" data-stat="skill">
            </div>
            <div class="form-group">
                <label>ELME:</label>
                <input type="number" min="0" max="99" value="0" data-stat="mind">
            </div>
        </div>
    </template>

    <template id="spell-item-template">
        <div class="spell-item">
            <div class="spell-checkbox"></div>
            <div class="spell-info">
                <span class="spell-name" data-spell-name></span>
                <span class="spell-requirement" data-spell-req></span>
            </div>
        </div>
    </template>

    <template id="history-item-template">
        <div class="history-item">
            <span class="history-time" data-time></span>
            <span class="history-dice" data-dice></span>
            <span class="history-total" data-total></span>
            <span class="history-details" data-details></span>
        </div>
    </template>

    <script type="module" src="js/app.js"></script>
</body>

</html>