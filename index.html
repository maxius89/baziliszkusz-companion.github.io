<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Kalandlap - Digit√°lis karakterlap A Baziliszkusz √Årny√©ka c. k√∂nyvh√∂z">
    <title>A Baziliszkus √Årny√©ka - Kalandlap</title>
    <!-- CSS Modules - Order matters! -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/chargen.css">
    <link rel="stylesheet" href="css/dice.css">
    <link rel="stylesheet" href="css/puzzle.css">
</head>

<body>
    <div class="container">
        <main class="parchment">
            <!-- Header -->
            <header>
                <h1>KALANDLAP</h1>
            </header>

            <!-- Main Content Grid -->
            <div class="content-grid">
                <!-- Player Stats -->
                <section class="stats-section" aria-label="Karakter statisztik√°k">
                    <div class="form-group">
                        <label for="body">TEST:</label>
                        <input type="number" id="body" min="0" max="99" value="0" aria-label="Test √©rt√©k">
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="skill">KECSESS√âG:</label>
                        <input type="number" id="skill" min="0" max="99" value="0" aria-label="Kecsess√©g √©rt√©k">
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="mind">ELME:</label>
                        <input type="number" id="mind" min="0" max="99" value="0" aria-label="Elme √©rt√©k">
                    </div>
                </section>

                <!-- Character Background -->
                <section class="combat-section" aria-label="Karakter h√°tt√©r">
                    <div class="form-group">
                        <label for="class">ALKASZT:</label>
                        <select id="class" aria-label="V√°lassz alkasztot">
                            <option value="">-- V√ÅLASSZ --</option>
                            <option value="magusvadasz">M√°gusvad√°sz</option>
                            <option value="szabotor">Szabot≈ër</option>
                            <option value="vereb">V√©reb</option>
                        </select>
                        <div class="field-bonus" id="classBonus"></div>
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="past">M√öLT:</label>
                        <select id="past" aria-label="V√°lassz m√∫ltat">
                            <option value="">-- V√ÅLASSZ --</option>
                            <option value="testor">Egy nagyhatalm√∫ m√°gus test≈ëre</option>
                            <option value="ostora">A Birodalom ellens√©geinek ostora</option>
                            <option value="tulelo">Magiko-technikus k√≠s√©rletek t√∫l√©l≈ëje</option>
                        </select>
                        <div class="field-bonus" id="pastBonus"></div>
                    </div>
                </section>

                <!-- Equipment -->
                <section class="equipment-section" aria-label="Felszerel√©s">
                    <div class="form-group">
                        <label for="equipment">FELSZEREL√âS:</label>
                        <textarea id="equipment" rows="12" aria-label="Felszerel√©s lista"></textarea>
                    </div>
                </section>

                <!-- Spells and Notes -->
                <section class="spells-notes-section" aria-label="Var√°zslatok √©s jegyzetek">
                    <div class="form-group">
                        <label for="spells">VAR√ÅZSLATOK:</label>
                        <textarea id="spells" rows="5" aria-label="Var√°zslatok lista"></textarea>
                    </div>

                    <div class="divider"></div>

                    <div class="form-group">
                        <label for="notes">FELJEGYZ√âSEK:</label>
                        <textarea id="notes" rows="5" aria-label="Jegyzetek"></textarea>
                    </div>
                </section>

                <!-- Battle Tracker -->
                <section class="battle-grid" aria-label="Harc k√∂vet≈ë">
                    <!-- Battle cards will be generated by JavaScript -->
                </section>
            </div>

            <!-- Action Buttons -->
            <div class="actions">
                <button id="saveBtn" class="btn btn-primary">&#128190; MENT√âS</button>
                <button id="loadBtn" class="btn btn-secondary">&#128194; BET√ñLT√âS</button>
                <button id="exportBtn" class="btn btn-secondary">&#128229; EXPORT√ÅL√ÅS</button>
                <button id="importBtn" class="btn btn-secondary">&#128193; IMPORT√ÅL√ÅS</button>
                <button id="charGenBtn" class="btn btn-primary">&#9889; KARAKTER GENER√ÅL√ÅS</button>
                <button id="diceBtn" class="btn btn-primary">&#127922; KOCKADOB√ÅS</button>
                <button id="puzzleBtn" class="btn btn-secondary">üß© REJTV√âNY</button>
                <button id="helpBtn" class="btn btn-secondary">&#10067; S√öG√ì</button>
                <button id="resetBtn" class="btn btn-danger">&#128260; √öJRAKEZD√âS</button>
                <input type="file" id="importFile" accept=".json" style="display: none;">
            </div>

            <!-- Hidden file input -->
            <input type="file" id="importFile" accept=".json" style="display: none;" aria-hidden="true">
        </main>
    </div>

    <!-- Templates (hidden) -->
    <template id="dice-roller-template">
        <div class="dice-roller-content sidebar-content custom-scrollbar">
            <button class="sidebar-close" id="diceClose">‚úï</button>
            <h2>KOCKADOB√ÅS</h2>

            <div class="dice-section">
                <h3>Egyszer≈± dob√°s</h3>
                <div class="dice-result" id="diceResult">
                    <span class="result-number">?</span>
                </div>
                <div class="dice-buttons">
                    <button class="dice-btn" id="roll1d6">1D6</button>
                    <button class="dice-btn" id="roll2d6">2D6</button>
                </div>
            </div>

            <div class="dice-section">
                <h3>Harc dob√°s</h3>
                <div class="battle-rolls">
                    <div class="battle-roll">
                        <h4>J√ÅT√âKOS</h4>
                        <div class="battle-result" id="attackerRoll">?</div>
                    </div>
                    <div class="battle-roll">
                        <h4>ELLENF√âL</h4>
                        <div class="battle-result" id="defenderRoll">?</div>
                    </div>
                </div>
                <div class="dice-buttons">
                    <button class="dice-btn" id="rollBattle">HARC DOB√ÅS</button>
                </div>
            </div>

            <div class="dice-history" id="diceHistory">
                <h3>T√ñRT√âNET</h3>
                <div class="history-items"></div>
            </div>
        </div>
    </template>

    <template id="chargen-template">
        <div class="chargen-content sidebar-content custom-scrollbar">
            <button class="sidebar-close" id="chargenClose">‚úï</button>
            <h2>KARAKTER GENER√ÅL√ÅS</h2>

            <div class="chargen-info">
                <strong>Alap √©rt√©kek:</strong><br>
                Test: 18 | Kecsess√©g: 7 | Elme: 7<br>
                Max var√°zslatok: 1<br><br>
                <strong>14 fejl≈ëd√©spont</strong> √°ll rendelkez√©sre.
            </div>

            <!-- Points Display -->
            <div class="chargen-section">
                <div class="points-display">
                    <div class="points-remaining" id="pointsRemaining">14</div>
                    <div class="points-label">Fejl≈ëd√©spont</div>
                </div>
            </div>

            <!-- Stats (TEST, KECSESS√âG, ELME, MAX VAR√ÅZSLATOK) -->
            <div class="chargen-section">
                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">TEST</span>
                        <span class="stat-value" id="genBody">18</span>
                    </div>
                    <div class="stat-controls" id="bodyControls"></div>
                    <div class="stat-cost">+1 = 1 pont (max +10)</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">KECSESS√âG</span>
                        <span class="stat-value" id="genSkill">7</span>
                    </div>
                    <div class="stat-controls" id="skillControls"></div>
                    <div class="stat-cost">+1 = 2 pont | +2 = 5 pont | +3 = 9 pont</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">ELME</span>
                        <span class="stat-value" id="genMind">7</span>
                    </div>
                    <div class="stat-controls" id="mindControls"></div>
                    <div class="stat-cost">+1 = 2 pont | +2 = 5 pont | +3 = 9 pont</div>
                </div>

                <div class="stat-row">
                    <div class="stat-header">
                        <span class="stat-name">MAX VAR√ÅZSLATOK</span>
                        <span class="stat-value" id="genSpells">1</span>
                    </div>
                    <div class="stat-controls" id="spellsControls"></div>
                    <div class="stat-cost">+1 = 4 pont | +2 = 8 pont (max +2)</div>
                </div>
            </div>

            <!-- Spell Selection -->
            <div class="chargen-section">
                <div class="spell-selection">
                    <h4>VAR√ÅZSLAT V√ÅLASZT√ÅS</h4>
                    <div class="spell-list" id="spellList"></div>
                    <div class="spell-counter" id="spellCounter">
                        <span id="selectedSpellCount">0</span> / <span id="maxSpellCount">1</span> var√°zslat kiv√°lasztva
                    </div>
                </div>
            </div>

            <!-- Class Selection -->
            <div class="chargen-section">
                <div class="class-background-selection">
                    <h3>ALKASZT</h3>
                    <select id="classSelect" class="class-select">
                        <option value="">-- V√ÅLASSZ --</option>
                        <option value="magusvadasz">M√°gusvad√°sz</option>
                        <option value="szabotor">Szabot≈ër</option>
                        <option value="vereb">V√©reb</option>
                    </select>
                    <div class="bonus-display" id="classBonus" style="display: none;"></div>
                </div>
            </div>

            <!-- Background Selection -->
            <div class="chargen-section">
                <div class="class-background-selection">
                    <h3>M√öLT</h3>
                    <select id="backgroundSelect" class="background-select">
                        <option value="">-- V√ÅLASSZ --</option>
                        <option value="testor">Egy nagyhatalm√∫ m√°gus test≈ëre</option>
                        <option value="ostora">A Birodalom ellens√©geinek ostora</option>
                        <option value="tulelo">Magiko-technikus k√≠s√©rletek t√∫l√©l≈ëje</option>
                    </select>
                    <div class="bonus-display" id="backgroundBonus" style="display: none;"></div>
                </div>
            </div>

            <!-- Actions -->
            <div class="chargen-actions">
                <button class="action-btn primary" id="applyCharGen">
                    &#10004; ALKALMAZ
                </button>
                <button class="action-btn" id="resetCharGen">
                    &#8634; VISSZA√ÅLL√çT
                </button>
            </div>
        </div>
    </template>

    <template id="help-modal-template">
        <div class="help-content">
            <button class="help-close">‚úï</button>
            <h2>S√öG√ì</h2>

            <h3>Billenty≈±parancsok</h3>
            <div class="help-shortcuts">
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + S</span>
                    <span class="shortcut-desc">Kalandlap ment√©se</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + L</span>
                    <span class="shortcut-desc">Kalandlap bet√∂lt√©se</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + E</span>
                    <span class="shortcut-desc">Export√°l√°s f√°jlba</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + I</span>
                    <span class="shortcut-desc">Import√°l√°s f√°jlb√≥l</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + G</span>
                    <span class="shortcut-desc">Karakter gener√°l√°s</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + D</span>
                    <span class="shortcut-desc">Kockadob√≥ megnyit√°sa</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + P</span>
                    <span class="shortcut-desc">Rejtv√©nyfejt≈ë megnyit√°sa</span>
                </div>
                <div class="shortcut-item">
                    <span class="shortcut-key">Ctrl + H</span>
                    <span class="shortcut-desc">S√∫g√≥ megjelen√≠t√©se</span>
                </div>
            </div>

            <h3>Funkci√≥k</h3>
            <ul class="help-features">
                <li><strong>Automatikus ment√©s:</strong> Az adatok 30 m√°sodpercenk√©nt automatikusan ment√©sre ker√ºlnek
                </li>
                <li><strong>Helyi t√°rol√°s:</strong> Az adatok a b√∂ng√©sz≈ë helyi t√°rhely√©n ker√ºlnek ment√©sre</li>
                <li><strong>Export/Import:</strong> JSON f√°jlba mentheted √©s onnan visszat√∂ltheted az adatokat</li>
                <li><strong>Kockadob√≥:</strong> 1D6, 2D6 dob√°sa √©s harc dob√°s 2D6 vs 2D6</li>
                <li><strong>Karakter gener√°l√°s:</strong> A k√∂nyv szab√°lyai alapj√°n</li>
                <li><strong>Ellenf√©l k√∂vet√©s:</strong> 9 ellenf√©l statisztik√°inak nyomon k√∂vet√©se</li>
            </ul>
        </div>
    </template>


    <template id="legend-item-template">
        <div class="legend-item" role="cell">
            <span class="legend-letter" data-legend-letter></span>
            <span class="legend-value" data-legend-value></span>
        </div>
    </template>

    <template id="puzzle-modal-template">
        <div class="puzzle-content">
            <button class="puzzle-close" aria-label="Bez√°r">√ó</button>

            <h2>REJTV√âNYFEJT≈ê</h2>

            <div class="puzzle-info">
                <p><strong>Hogyan m≈±k√∂dik:</strong> √çrd be a rejtv√©ny megold√°s√°t, √©s automatikusan megkapod a megfelel≈ë
                    sz√°mot!</p>
            </div>

            <div class="puzzle-input-section">
                <label for="puzzleInput">MEGOLD√ÅS:</label>
                <input type="text" id="puzzleInput" class="puzzle-input" placeholder="√çrd be a bet≈±ket..."
                    autocomplete="off" aria-describedby="puzzleInfo" />
            </div>

            <div class="puzzle-breakdown" id="puzzleBreakdown" aria-live="polite"></div>

            <div class="puzzle-result-section">
                <div class="puzzle-result-label">EREDM√âNY:</div>
                <div class="puzzle-result" id="puzzleResult" aria-live="polite">0</div>
            </div>

            <div class="puzzle-legend">
                <h3 class="legend-toggle" role="button" tabindex="0" aria-expanded="false">
                    <span class="toggle-icon" aria-hidden="true">‚ñº</span>
                    <span>Bet≈±-Sz√°m T√°bl√°zat</span>
                </h3>
                <div class="legend-grid" role="table" aria-label="Bet≈±-sz√°m t√°bl√°zat">
                    <!-- Generated dynamically from LETTER_VALUES -->
                </div>
            </div>
        </div>
    </template>

    <template id="battle-card-template">
        <div class="battle-card">
            <div class="form-group">
                <label>TEST:</label>
                <input type="number" min="0" max="99" value="0" data-stat="body">
            </div>
            <div class="form-group">
                <label>KECSESS√âG:</label>
                <input type="number" min="0" max="99" value="0" data-stat="skill">
            </div>
            <div class="form-group">
                <label>ELME:</label>
                <input type="number" min="0" max="99" value="0" data-stat="mind">
            </div>
        </div>
    </template>

    <template id="spell-item-template">
        <div class="spell-item">
            <div class="spell-checkbox"></div>
            <div class="spell-info">
                <span class="spell-name" data-spell-name></span>
                <span class="spell-requirement" data-spell-req></span>
            </div>
        </div>
    </template>

    <template id="history-item-template">
        <div class="history-item">
            <span class="history-time" data-time></span>
            <span class="history-dice" data-dice></span>
            <span class="history-total" data-total></span>
            <span class="history-details" data-details></span>
        </div>
    </template>

    <template id="breakdown-item-template">
        <div class="breakdown-item">
            <span class="breakdown-letter" data-letter></span>
            <span class="breakdown-value" data-value></span>
        </div>
    </template>

    <script type="module" src="js/app.js"></script>
</body>

</html>